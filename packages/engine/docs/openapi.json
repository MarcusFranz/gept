{"openapi":"3.1.0","info":{"title":"GePT Recommendation Engine","description":"OSRS Grand Exchange flipping recommendation API","version":"2.0.0"},"paths":{"/api/v1/health":{"get":{"summary":"Health Check","description":"Check system health status.","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/v1/recommendations":{"post":{"summary":"Get Recommendations","description":"Get recommendations formatted for Discord bot.\n\nThis is the main endpoint for the Discord bot to fetch flip recommendations.\nTakes user constraints (capital, style, risk, slots) and returns optimized trades.\nAccounts for active trades to calculate remaining capital and available slots.","operationId":"get_recommendations_api_v1_recommendations_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecommendationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RecommendationResponse"},"title":"Response Get Recommendations Api V1 Recommendations Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"summary":"Get Recommendations Get","description":"Get recommendations via GET request.\n\nAlternative endpoint for Discord bot using query parameters.\nSupports exclude parameter to filter out already-seen recommendations.\nSupports exclude_item_ids to filter out specific items (e.g., active trades).","operationId":"get_recommendations_get_api_v1_recommendations_get","parameters":[{"name":"style","in":"query","required":false,"schema":{"enum":["passive","hybrid","active"],"type":"string","default":"hybrid","title":"Style"}},{"name":"capital","in":"query","required":true,"schema":{"type":"integer","minimum":1000,"description":"Available capital in gp","title":"Capital"},"description":"Available capital in gp"},{"name":"risk","in":"query","required":false,"schema":{"enum":["low","medium","high"],"type":"string","default":"medium","title":"Risk"}},{"name":"slots","in":"query","required":false,"schema":{"type":"integer","maximum":8,"minimum":1,"description":"Available GE slots","default":4,"title":"Slots"},"description":"Available GE slots"},{"name":"exclude","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Comma-separated recommendation IDs to exclude","title":"Exclude"},"description":"Comma-separated recommendation IDs to exclude"},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"User identifier for crowding tracking","title":"User Id"},"description":"User identifier for crowding tracking"},{"name":"exclude_item_ids","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Comma-separated item IDs to exclude (e.g., '536,5295,4151')","title":"Exclude Item Ids"},"description":"Comma-separated item IDs to exclude (e.g., '536,5295,4151')"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RecommendationResponse"},"title":"Response Get Recommendations Get Api V1 Recommendations Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recommendations/item/{item_id}":{"get":{"summary":"Get Recommendation By Item Id","description":"Get recommendation for a specific item by ID.\n\nIf user context (capital, risk, style) is provided, generates a fresh recommendation\ntailored to user preferences. Otherwise returns cached recommendation.\n\nReturns full recommendation if item is good to flip, or explanation if not\nrecommended. Use include_price_history=true for expanded view with mini chart data.","operationId":"get_recommendation_by_item_id_api_v1_recommendations_item__item_id__get","parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"integer","title":"Item Id"}},{"name":"capital","in":"query","required":false,"schema":{"anyOf":[{"type":"integer","minimum":1000},{"type":"null"}],"description":"Available capital in gp","title":"Capital"},"description":"Available capital in gp"},{"name":"risk","in":"query","required":false,"schema":{"anyOf":[{"enum":["low","medium","high"],"type":"string"},{"type":"null"}],"description":"Risk tolerance","title":"Risk"},"description":"Risk tolerance"},{"name":"style","in":"query","required":false,"schema":{"anyOf":[{"enum":["passive","hybrid","active"],"type":"string"},{"type":"null"}],"description":"Trading style","title":"Style"},"description":"Trading style"},{"name":"slots","in":"query","required":false,"schema":{"anyOf":[{"type":"integer","maximum":8,"minimum":1},{"type":"null"}],"description":"Available GE slots","title":"Slots"},"description":"Available GE slots"},{"name":"include_price_history","in":"query","required":false,"schema":{"type":"boolean","description":"Include 24h price history for charts","default":false,"title":"Include Price History"},"description":"Include 24h price history for charts"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recommendations/item":{"get":{"summary":"Get Recommendation By Item Name","description":"Get recommendation for a specific item by name (with fuzzy matching).\n\nSearches for items matching the name and returns a recommendation for the best\nmatch. Returns full recommendation if item is good to flip, or explanation if\nnot recommended. If item not found, returns suggestions.","operationId":"get_recommendation_by_item_name_api_v1_recommendations_item_get","parameters":[{"name":"name","in":"query","required":true,"schema":{"type":"string","description":"Item name to search for","title":"Name"},"description":"Item name to search for"},{"name":"capital","in":"query","required":true,"schema":{"type":"integer","minimum":1000,"description":"Available capital in gp","title":"Capital"},"description":"Available capital in gp"},{"name":"risk","in":"query","required":false,"schema":{"enum":["low","medium","high"],"type":"string","description":"Risk tolerance","default":"medium","title":"Risk"},"description":"Risk tolerance"},{"name":"style","in":"query","required":false,"schema":{"enum":["passive","hybrid","active"],"type":"string","description":"Trading style","default":"hybrid","title":"Style"},"description":"Trading style"},{"name":"slots","in":"query","required":false,"schema":{"type":"integer","maximum":8,"minimum":1,"description":"Available GE slots","default":4,"title":"Slots"},"description":"Available GE slots"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recommendations/{rec_id}":{"get":{"summary":"Get Recommendation By Id","description":"Get a specific recommendation by its ID.\n\nUsed when user clicks \"Mark Ordered\" in Discord bot.","operationId":"get_recommendation_by_id_api_v1_recommendations__rec_id__get","parameters":[{"name":"rec_id","in":"path","required":true,"schema":{"type":"string","title":"Rec Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/RecommendationResponse"},{"type":"null"}],"title":"Response Get Recommendation By Id Api V1 Recommendations  Rec Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/predictions/{item_id}":{"get":{"summary":"Get Item Predictions","description":"Get full prediction details for a specific item.\n\nReturns all hour_offset/offset_pct combinations for the item.","operationId":"get_item_predictions_api_v1_predictions__item_id__get","parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"integer","title":"Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ItemPredictionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/items/search":{"get":{"summary":"Search Items","description":"Search for items by name with fuzzy matching.\n\nSupports case-insensitive search with typo tolerance for Discord autocomplete.\nReturns top N matches sorted by relevance score.\n\nArgs:\n    q: Search query string (minimum 1 character)\n    limit: Maximum number of results to return (1-25, default 10)\n\nReturns:\n    List of matching items with itemId and name","operationId":"search_items_api_v1_items_search_get","parameters":[{"name":"q","in":"query","required":true,"schema":{"type":"string","minLength":1,"description":"Search query","title":"Q"},"description":"Search query"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":25,"minimum":1,"description":"Maximum number of results","default":10,"title":"Limit"},"description":"Maximum number of results"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ItemSearchResult"},"title":"Response Search Items Api V1 Items Search Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/recommendations/{rec_id}/outcome":{"post":{"summary":"Report Trade Outcome","description":"Record a trade outcome for ML feedback loop.\n\nUsers report trade outcomes via Discord bot's /report command or when marking\ntrades as \"Filled\" in active trades. This data feeds back into the prediction\nmodel to improve accuracy over time.\n\nPrivacy:\n- User IDs must be hashed (SHA256) before sending\n- No Discord IDs or PII stored\n- Data used only for model training\n\nArgs:\n    rec_id: Recommendation ID that led to this trade\n    request: Trade outcome details","operationId":"report_trade_outcome_api_v1_recommendations__rec_id__outcome_post","parameters":[{"name":"rec_id","in":"path","required":true,"schema":{"type":"string","title":"Rec Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TradeOutcomeRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TradeOutcomeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint with API info.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ActiveTrade":{"properties":{"itemId":{"type":"integer","title":"Itemid"},"quantity":{"type":"integer","title":"Quantity"},"buyPrice":{"type":"integer","title":"Buyprice"}},"type":"object","required":["itemId","quantity","buyPrice"],"title":"ActiveTrade","description":"An active trade the user is tracking."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","enum":["ok","warning","error"],"title":"Status"},"checks":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Checks"},"timestamp":{"type":"string","title":"Timestamp"},"recommendation_store_size":{"type":"integer","title":"Recommendation Store Size"},"crowding_stats":{"additionalProperties":true,"type":"object","title":"Crowding Stats"}},"type":"object","required":["status","checks","timestamp","recommendation_store_size","crowding_stats"],"title":"HealthResponse","description":"Health check response."},"ItemPredictionResponse":{"properties":{"item_id":{"type":"integer","title":"Item Id"},"item_name":{"type":"string","title":"Item Name"},"best_config":{"additionalProperties":true,"type":"object","title":"Best Config"},"fill_probability":{"type":"number","title":"Fill Probability"},"expected_value":{"type":"number","title":"Expected Value"},"buy_price":{"type":"integer","title":"Buy Price"},"sell_price":{"type":"integer","title":"Sell Price"},"confidence":{"type":"string","title":"Confidence"},"all_predictions":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"All Predictions"}},"type":"object","required":["item_id","item_name","best_config","fill_probability","expected_value","buy_price","sell_price","confidence","all_predictions"],"title":"ItemPredictionResponse","description":"Full prediction details for an item."},"ItemSearchResult":{"properties":{"itemId":{"type":"integer","title":"Itemid"},"name":{"type":"string","title":"Name"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"}},"type":"object","required":["itemId","name"],"title":"ItemSearchResult","description":"Item search result for autocomplete."},"PriceHistoryPoint":{"properties":{"timestamp":{"type":"string","title":"Timestamp"},"price":{"type":"integer","title":"Price"}},"type":"object","required":["timestamp","price"],"title":"PriceHistoryPoint","description":"A single point in price history."},"RecommendationRequest":{"properties":{"style":{"type":"string","enum":["passive","hybrid","active"],"title":"Style","default":"hybrid"},"capital":{"type":"integer","minimum":1000.0,"title":"Capital","description":"Total capital in gp"},"risk":{"type":"string","enum":["low","medium","high"],"title":"Risk","default":"medium"},"slots":{"type":"integer","maximum":8.0,"minimum":1.0,"title":"Slots","description":"Total GE slots","default":4},"activeTrades":{"items":{"$ref":"#/components/schemas/ActiveTrade"},"type":"array","title":"Activetrades","description":"Currently tracked trades","default":[]},"userId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Userid","description":"User identifier for crowding tracking"}},"type":"object","required":["capital"],"title":"RecommendationRequest","description":"Request for Discord bot recommendations."},"RecommendationResponse":{"properties":{"id":{"type":"string","title":"Id"},"itemId":{"type":"integer","title":"Itemid"},"item":{"type":"string","title":"Item"},"buyPrice":{"type":"integer","title":"Buyprice"},"sellPrice":{"type":"integer","title":"Sellprice"},"quantity":{"type":"integer","title":"Quantity"},"capitalRequired":{"type":"integer","title":"Capitalrequired"},"expectedProfit":{"type":"integer","title":"Expectedprofit"},"confidence":{"type":"string","enum":["high","medium","low"],"title":"Confidence"},"volumeTier":{"type":"string","enum":["Very High","High","Medium","Low"],"title":"Volumetier"},"trend":{"type":"string","enum":["Rising","Stable","Falling"],"title":"Trend"},"expectedHours":{"type":"integer","title":"Expectedhours"},"volume24h":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Volume24H"},"priceHistory":{"anyOf":[{"items":{"$ref":"#/components/schemas/PriceHistoryPoint"},"type":"array"},{"type":"null"}],"title":"Pricehistory"}},"type":"object","required":["id","itemId","item","buyPrice","sellPrice","quantity","capitalRequired","expectedProfit","confidence","volumeTier","trend","expectedHours"],"title":"RecommendationResponse","description":"Discord bot recommendation response."},"TradeOutcomeRequest":{"properties":{"userId":{"type":"string","title":"Userid","description":"Hashed user ID (SHA256 of Discord ID)"},"itemId":{"type":"integer","title":"Itemid","description":"OSRS item ID"},"itemName":{"type":"string","title":"Itemname","description":"Item name"},"recId":{"type":"string","title":"Recid","description":"Recommendation ID that led to this trade"},"buyPrice":{"type":"integer","minimum":1.0,"title":"Buyprice","description":"Buy price in gp"},"sellPrice":{"type":"integer","minimum":1.0,"title":"Sellprice","description":"Sell price in gp"},"quantity":{"type":"integer","minimum":1.0,"title":"Quantity","description":"Quantity traded"},"actualProfit":{"type":"integer","title":"Actualprofit","description":"Actual profit/loss after GE tax (can be negative)"},"reportedAt":{"type":"string","title":"Reportedat","description":"ISO 8601 timestamp when user reported outcome"}},"type":"object","required":["userId","itemId","itemName","recId","buyPrice","sellPrice","quantity","actualProfit","reportedAt"],"title":"TradeOutcomeRequest","description":"Request to report a trade outcome."},"TradeOutcomeResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","message"],"title":"TradeOutcomeResponse","description":"Response after recording a trade outcome."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}